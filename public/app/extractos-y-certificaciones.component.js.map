{"version":3,"sources":["extractos-y-certificaciones.component.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,sCAAkD;AAElD,uDAAqD;AACrD,0CAAkD;AAClD,iCAA+B;AAC/B,sCAAqC;AAGrC;;GAEG;AAMH;IAoBE,kCACU,eAA+B,EAC/B,cAA6B,EAC7B,IAAU;QAFV,oBAAe,GAAf,eAAe,CAAgB;QAC/B,mBAAc,GAAd,cAAc,CAAe;QAC7B,SAAI,GAAJ,IAAI,CAAM;QAtBpB,sBAAiB,GAAU,EAAE,CAAA;QAC7B,UAAK,GAAU,EAAE,CAAA;QAIjB,kBAAa,GAAG,IAAI,CAAA;QACpB,uBAAkB,GAAG,IAAI,CAAA;QACzB,iBAAY,GAAG,IAAI,CAAA;QACnB,aAAQ,GAAG,IAAI,CAAA;QACf,WAAM,GAAG,EAAE,CAAA;QAMJ,cAAS,GAAY,CAAC,CAAC;QACvB,cAAS,GAAY,CAAC,CAAC;QACvB,eAAU,GAAG,CAAC,OAAO,EAAE,SAAS,EAAE,OAAO,EAAC,OAAO,EAAE,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE,YAAY,EAAE,SAAS,EAAE,WAAW,EAAE,WAAW,CAAC,CAAC;IAOhJ,CAAC;IAEF,2CAAQ,GAAR;QAAA,iBA6CC;QA5CC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,SAAS,CAClC,UAAA,MAAM;YACJ,KAAI,CAAC,iBAAiB,GAAG,MAAM,CAAC,IAAI,CAAC;gBACrC,KAAI,CAAC,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,CAAA;QAC7B,CAAC,CACF,CAAA;QACD,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,IAAI,CAAC,iBAAiB,EAAC,IAAI,CAAC,KAAK,CAAC;aAChE,SAAS,CACR,UAAA,IAAI,IAAM,KAAI,CAAC,SAAS,GAAG,IAAI,CAAA,CAAC,CAAC,EACjC,UAAA,KAAK,IAAI,OAAA,OAAO,CAAC,GAAG,CAAE,iBAAiB,CAAE,EAAhC,CAAgC,EACzC;YACI,KAAI,CAAC,KAAK,GAAG,IAAI,IAAI,EAAE,CAAA;YACvB,KAAI,CAAC,eAAe,CAAC,UAAU,CAAC,KAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,SAAS,CAC/D,UAAA,QAAQ;gBACJ,IAAG,QAAQ,CAAC,QAAQ,EAAC;oBACnB,KAAI,CAAC,mBAAmB,GAAG,qEAAqE,GAAE,KAAI,CAAC,SAAS,CAAC,OAAO,GAAE,MAAM,CAAA;iBACjI;YACL,CAAC,CACF,CAAA;YACD,KAAI,CAAC,eAAe,CAAC,oBAAoB,CAAC,KAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,SAAS,CACzE,UAAA,QAAQ;gBACJ,IAAG,QAAQ,CAAC,QAAQ,EAAC;oBACnB,KAAI,CAAC,kBAAkB,GAAG,kEAAkE,GAAE,KAAI,CAAC,SAAS,CAAC,OAAO,GAAE,MAAM,CAAA;iBAC7H;YACL,CAAC,CACF,CAAA;YACD,KAAI,CAAC,SAAS,GAAG,CAAC,CAAC;QACvB,CAAC,CACF,CAAC;QAEJ,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,IAAI,CAAC,iBAAiB,EAAC,IAAI,CAAC,KAAK,CAAC,CAAC,SAAS,CAC1E,UAAA,IAAI,IAAM,KAAI,CAAC,WAAW,GAAG,IAAI,CAAA,CAAC,CAAC,EACnC,UAAA,KAAK,IAAI,OAAA,OAAO,CAAC,GAAG,CAAE,iBAAiB,CAAE,EAAhC,CAAgC,EACzC,cAAQ,KAAI,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC,CAAC,CAC9B,CAAA;QAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;YAC3B,IAAI,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;YACtB,IAAG,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE;gBACtB,IAAI,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,GAAC,CAAC,EAAE,CAAC,CAAC,CAAC;aAC3D;YACD,IAAI,QAAQ,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,GAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAClE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAC5B;IACH,CAAC;IAGD,iDAAc,GAAd;QAAA,iBA2BC;QA1BC,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;QAClB,IAAI,CAAC,kBAAkB,GAAG,CAAC,CAAC,qBAAqB,CAAC,CAAC,GAAG,EAAE,CAAA;QACxD,IAAG,IAAI,CAAC,kBAAkB,IAAI,IAAI,EAAC;YACjC,CAAC,CAAC,qBAAqB,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAC,0BAA0B,CAAC,CAAC;YACjE,OAAO;SACT;QACD,qHAAqH;QACpH,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC,SAAS,CACtF,UAAA,IAAI;YACF,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE,IAAI,EAAE,iBAAiB,EAAC,CAAC,CAAC;YAC/D,IAAI,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;YAC3C,IAAI,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;YACpC,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;YACzB,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;YAC7B,CAAC,CAAC,IAAI,GAAG,GAAG,CAAC;YACb,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,KAAI,CAAC,KAAK,CAAC,CAAC;YAChC,IAAI,UAAU,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACjC,IAAI,IAAI,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;YAC9B,CAAC,CAAC,YAAY,CAAC,UAAU,EAAE,cAAc,GAAC,KAAI,CAAC,UAAU,CAAC,UAAU,CAAC,GAAG,GAAG,GAAG,IAAI,GAAG,MAAM,CAAC,CAAC;YAC7F,CAAC,CAAC,KAAK,EAAE,CAAC;YACV,MAAM,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;YACnC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;QAC9B,CAAC,EACF,UAAA,KAAK,IAAK,CAAC,EACX,cAAQ,KAAI,CAAC,SAAS,GAAI,CAAC,CAAA,CAAC,CAAC,CAC9B,CAAA;IACL,CAAC;IAED,gDAAa,GAAb;QAAA,iBAmCC;QAlCC,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;QACnB,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC,eAAe,CAAC,CAAC,GAAG,EAAE,CAAA;QAC5C,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC,gBAAgB,CAAC,CAAC,GAAG,EAAE,CAAA;QAC9C,IAAG,IAAI,CAAC,YAAY,IAAI,IAAI,IAAI,IAAI,CAAC,aAAa,IAAI,IAAI,EAAC;YACzD,CAAC,CAAC,gBAAgB,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAC,0BAA0B,CAAC,CAAC;YAC7D,CAAC,CAAC,eAAe,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAC,0BAA0B,CAAC,CAAC;YAC5D,OAAO;SACR;QACD,IAAI,KAAK,GAAI,IAAI,CAAC,YAAY,CAAA;QAC9B,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;QACzC,+GAA+G;QAC/G,8BAA8B;QAE5B,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,SAAS,CACvF,UAAA,IAAI;YACF,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAA;YACxB,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE,IAAI,EAAE,iBAAiB,EAAC,CAAC,CAAC;YAC/D,IAAI,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;YAC3C,IAAI,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;YACpC,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;YACzB,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;YAC7B,CAAC,CAAC,IAAI,GAAG,GAAG,CAAC;YACb,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,KAAI,CAAC,KAAK,CAAC,CAAC;YAChC,IAAI,UAAU,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACjC,IAAI,IAAI,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;YAC9B,CAAC,CAAC,YAAY,CAAC,UAAU,EAAE,cAAc,GAAC,KAAI,CAAC,UAAU,CAAC,UAAU,CAAC,GAAG,GAAG,GAAG,IAAI,GAAG,MAAM,CAAC,CAAC;YAC7F,CAAC,CAAC,KAAK,EAAE,CAAC;YACV,MAAM,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;YACnC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;QAC9B,CAAC,EACF,UAAA,KAAK,IAAK,CAAC,EACX,cAAQ,KAAI,CAAC,SAAS,GAAI,CAAC,CAAA,CAAC,CAAC,CAC9B,CAAA;IAEL,CAAC;IAED,iDAAc,GAAd;QACE,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC,gBAAgB,CAAC,CAAC,GAAG,EAAE,CAAA;QACzC,IAAG,IAAI,CAAC,QAAQ,IAAI,IAAI,EAAC;YACvB,CAAC,CAAC,gBAAgB,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAC,0BAA0B,CAAC,CAAC;YAC7D,OAAO;SACR;QACD,+FAA+F;QAC/F,IAAI,GAAG,GAAG,sBAAsB,CAAA;QAChC,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;IAC9B,CAAC;IAED,+CAAY,GAAZ,UAAc,IAAY;QACxB,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;IAC/B,CAAC;IAED,uDAAoB,GAApB;QACE,IAAI,YAAY,GAAG,CAAC,CAAC,eAAe,CAAC,CAAC,GAAG,EAAE,CAAC;QAC5C,IAAG,YAAY,IAAI,EAAE,EAAC;YACpB,KAAK,CAAC,+BAA+B,CAAC,CAAC;YACvC,CAAC,CAAC,eAAe,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAC,0BAA0B,CAAC,CAAC;YAC5D,OAAO,KAAK,CAAC;SACd;QACD,IAAI,OAAO,GAAE,IAAI,IAAI,EAAE,CAAE;QACzB,IAAI,KAAK,GAAG,CAAE,CAAE,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC,CAAA,CAAC,CAAA,OAAO,CAAC,QAAQ,EAAE,GAAC,CAAC,CAAC;QACnG,IAAI,GAAG,GAAG,CAAE,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAC,OAAO,CAAC,OAAO,EAAE,CAAA,CAAC,CAAA,OAAO,CAAC,OAAO,EAAE,CAAC;QAC9E,IAAI,IAAI,GAAG,OAAO,CAAC,WAAW,EAAE,CAAC;QACjC,IAAI,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,KAAK,GAAG,GAAG,GAAG,GAAG,CAAC;QAC1C,IAAI,CAAC,SAAS,CAAC,OAAO,CAAA;QACtB,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,4BAA4B,GAAC,IAAI,CAAC,SAAS,CAAC,OAAO,GAAC,GAAG,GAAC,IAAI,GAAC,GAAG,GAAE,YAAY,CAAC,CAAC;IAE1G,CAAC;IAED,mDAAgB,GAAhB,UAAiB,KAAa,EAAE,IAAY;QAC1C,IAAI,QAAQ,CAAC;QACb,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,UAAU,GAAG;YACrC,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,KAAK,IAAI,IAAI,EAAC;gBAC3B,QAAQ,GAAG,IAAI,CAAC;aACjB;QACJ,CAAC,CAAC,CAAC;QACH,OAAO,QAAQ,CAAC;IAClB,CAAC;IArLU,wBAAwB;QALpC,gBAAS,CAAC;YACT,QAAQ,EAAE,QAAQ;YAClB,WAAW,EAAE,iDAAiD;YAC9D,SAAS,EAAE,CAAC,kCAAe,CAAC;SAC7B,CAAC;yCAsB0B,kCAAe;YAChB,uBAAc;YACvB,WAAI;OAvBT,wBAAwB,CAyLpC;IAAD,+BAAC;CAzLD,AAyLC,IAAA;AAzLY,4DAAwB","file":"extractos-y-certificaciones.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { Observable }     from 'rxjs/Observable';\nimport { ProductsService } from './personal.service';\nimport { ActivatedRoute  } from '@angular/router';\nimport 'rxjs/add/operator/map';\nimport { Http } from '@angular/http';\ndeclare var $: any\n\n/**\n * Componente para la pagina de salfos y movimientos firma\n */\n@Component({\n  selector: 'my-app',\n  templateUrl: '/app/templates/extractos-y-certificaciones.html',\n  providers: [ProductsService],\n})\nexport class ExtractosCertificaciones implements OnInit {\n  id_identificacion:string = ''\n  fecha:string = ''\n  user_info:any;\n  fics_filter:Observable<Array<string>>;\n  today:any;\n  option_select = 'NA'\n  fecha_select_firma = 'NA'\n  fecha_select = 'NA'\n  download = 'NA'\n  fechas = []\n  info_movimientos:Observable<Array<string>>;\n  fondo:any;\n  encargo:any;\n  downloadCertificate: string;\n  downloadOperations: string;\n  public showForm1 : number = 0;\n  public showForm2 : number = 0;\n  public monthNames = [\"Enero\", \"Febrero\", \"Marzo\",\"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"];\n\n  constructor(\n    private productsService:ProductsService,\n    private activatedRoute:ActivatedRoute,\n    private http: Http,\n  )\n  {}\n\n  ngOnInit():void{\n    this.activatedRoute.params.subscribe(\n      params => {\n        this.id_identificacion = params['id'],\n        this.fecha = params['date']\n      }\n    )\n    this.productsService.getUserInfo(this.id_identificacion,this.fecha)\n      .subscribe(\n        data => { this.user_info = data },\n        error => console.log( 'Error: ${error}' ),\n        () => {\n            this.today = new Date()\n            this.productsService.verifyFile(this.user_info.codeoyd).subscribe(\n              response => {\n                  if(response.response){\n                    this.downloadCertificate = '/storage/documentos_ayuda/certificados_cartera/CertificadoCarteras_'+ this.user_info.codeoyd +'.pdf'\n                  }\n              }\n            )\n            this.productsService.verifyFileOperations(this.user_info.codeoyd).subscribe(\n              response => {\n                  if(response.response){\n                    this.downloadOperations = '/storage/documentos_ayuda/resumen_operaciones_anual/Certificado_'+ this.user_info.codeoyd +'.pdf'\n                  }\n              }\n            )\n            this.showForm1 = 1;\n        }\n      );\n\n    this.productsService.FicsFilter(this.id_identificacion,this.fecha).subscribe(\n      data => { this.fics_filter = data },\n      error => console.log( 'Error: ${error}' ),\n      () => { this.showForm2 = 1; }\n    )\n\n    for (var i = 1; i <= 6; i++) {\n      var date = new Date();\n      if(date.getDate() == 1) {\n        date = new Date(date.getFullYear(), date.getMonth()-1, 1);\n      }\n      var new_date = new Date(date.getFullYear(), date.getMonth()-i, 1);\n      this.fechas.push(new_date);\n    }\n  }\n\n\n  download_firma(){\n    this.showForm1 = 0;\n     this.fecha_select_firma = $('#fecha_select_firma').val()\n     if(this.fecha_select_firma == 'NA'){\n       $('#fecha_select_firma').css('border','1px solid rgb(255, 0, 0)');\n        return;\n     }\n     //window.location.replace('/download/reporte-firma-comisionista/'+this.id_identificacion+'/'+this.fecha_select_firma)\n      this.productsService.getFirma(this.id_identificacion, this.fecha_select_firma).subscribe(\n        data => { \n          let blob = new Blob([data.blob()], { type: 'application/pdf'});\n          let url = window.URL.createObjectURL(blob);\n          let a = document.createElement(\"a\");\n          a.style.display = \"none\";\n          document.body.appendChild(a);\n          a.href = url;\n          var date = new Date(this.fecha);\n          var monthIndex = date.getMonth();\n          var year = date.getFullYear();\n          a.setAttribute(\"download\", 'FC-Extracto-'+this.monthNames[monthIndex] + '-' + year + '.pdf');\n          a.click();\n          window.URL.revokeObjectURL(a.href);\n          document.body.removeChild(a);\n         },\n        error => {},\n        () => { this.showForm1  = 1 } \n      )\n  }\n\n  download_fics(){\n    this.showForm2 = 0;\n    this.fecha_select = $('#fecha_select').val()\n    this.option_select = $('#option_select').val()\n    if(this.fecha_select == 'NA' || this.option_select == 'NA'){\n      $('#option_select').css('border','1px solid rgb(255, 0, 0)');\n      $('#fecha_select').css('border','1px solid rgb(255, 0, 0)');\n      return;\n    }\n    var fecha  = this.fecha_select\n    var split = this.option_select.split('|')\n    //var url = '/download/reporte-fondos-de-inversion/'+this.id_identificacion+'/'+split[0]+'/'+split[2]+'/'+fecha\n    //window.location.replace(url)\n  \n      this.productsService.getFics(this.id_identificacion, split[0], split[2], fecha).subscribe(\n        data => { \n          console.log(data.blob())\n          let blob = new Blob([data.blob()], { type: 'application/pdf'});\n          let url = window.URL.createObjectURL(blob);\n          let a = document.createElement(\"a\");\n          a.style.display = \"none\";\n          document.body.appendChild(a);\n          a.href = url;\n          var date = new Date(this.fecha);\n          var monthIndex = date.getMonth();\n          var year = date.getFullYear();\n          a.setAttribute(\"download\", 'FI-Extracto-'+this.monthNames[monthIndex] + '-' + year + '.pdf');\n          a.click();\n          window.URL.revokeObjectURL(a.href);\n          document.body.removeChild(a);\n         },\n        error => {},\n        () => { this.showForm2  = 1 } \n      )\n\n  }\n\n  download_renta(){\n    this.download = $('#download_cert').val()\n    if(this.download == 'NA'){\n      $('#download_cert').css('border','1px solid rgb(255, 0, 0)');\n      return;\n    }\n    //var url = '/download-fics-extrac/'+this.id_identificacion+'/'+split[0]+'/'+split[2]+'/'+fecha\n    var url = '/download-renta/2016'\n    window.location.replace(url)\n  }\n\n  downloadCert( link: string){\n    window.location.replace(link)\n  }\n\n  downloadCertTenencia(){\n    let destinatario = $('#destinatario').val();\n    if(destinatario == ''){\n      alert('Debe escribir el destinatario');\n      $('#destinatario').css('border','1px solid rgb(255, 0, 0)');\n      return false;\n    }\n    var dateobj= new Date() ;\n    var month = ( ( dateobj.getMonth() + 1 ) <= 9) ? '0'+(dateobj.getMonth() + 1):dateobj.getMonth()+1;\n    var day = ( dateobj.getDate() <= 9) ? '0'+dateobj.getDate():dateobj.getDate();\n    var year = dateobj.getFullYear();\n    var date = year + '-' + month + '-' + day;\n    this.user_info.codeoyd\n    window.location.replace('/api/certificado-tenencia/'+this.user_info.codeoyd+'/'+date+'/'+ destinatario);\n\n  }\n\n  validateCodeFics(value: object, code: number) {\n    let validate;\n    Object.keys(value).forEach(function (key){\n       if (value[key].Fondo == code){\n         validate = true;\n       }\n    });\n    return validate;\n  }\n\n\n\n}\n"]}